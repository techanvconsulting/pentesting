# Active Directory Pentesting Checklist

## Reconnaissance

### 1. Information Gathering

- [ ] Collect information about the target network, domains, and subdomains.
- [ ] Identify domain controllers (DCs) and their roles.
- [ ] Enumerate domains, trusts, and forests.
- [ ] Gather information about users, groups, and computers.
- [ ] Discover organizational units (OUs) and Group Policy Objects (GPOs).
- [ ] Find service accounts and their permissions.

### 2. DNS Enumeration

- [ ] Enumerate DNS information for the target domains.
- [ ] Identify DNS zones and records.
- [ ] Check for DNS misconfigurations or vulnerabilities.
- [ ] Gather information about DNSSEC and DNSSecuring.

### 3. SMB Enumeration

- [ ] Enumerate SMB shares and permissions.
- [ ] Identify accessible shares, including hidden shares.
- [ ] Check for misconfigured shares or exposed sensitive data.

## Scanning and Enumeration

### 4. Port Scanning

- [ ] Perform port scanning to identify open ports and services.
- [ ] Enumerate commonly used ports (e.g., 135, 139, 445, 3389).
- [ ] Check for unusual or custom ports.

### 5. Service Enumeration

- [ ] Identify services running on target systems.
- [ ] Enumerate service versions and vulnerabilities.
- [ ] Pay attention to RPC, LDAP, SMB, and RDP services.

### 6. User Enumeration

- [ ] Enumerate users and groups.
- [ ] Gather information about user attributes.
- [ ] Check for locked or disabled accounts.
- [ ] Identify high-privilege users and administrators.

### 7. Password Policy Assessment

- [ ] Analyze password policies and complexity requirements.
- [ ] Check for password lockout policies and expiration settings.
- [ ] Look for password reuse vulnerabilities.

### 8. Kerberos Enumeration

- [ ] Enumerate Kerberos tickets and ticket-granting tickets (TGTs).
- [ ] Check for Kerberoasting vulnerabilities.
- [ ] Identify accounts with Kerberos pre-authentication disabled.

## Vulnerability Assessment

### 9. Vulnerability Scanning

- [ ] Perform vulnerability scanning using tools.
- [ ] Identify and categorize vulnerabilities.
- [ ] Prioritize vulnerabilities based on risk and impact.
- [ ] Validate findings to eliminate false positives.

## Exploitation

### 10. Credential Harvesting

- [ ] Attempt to harvest credentials using techniques like SMB relaying.
- [ ] Exploit pass-the-hash (PtH) and pass-the-ticket (PtT) attacks.

### 11. Pass-the-Hash (PtH) Attacks

- [ ] Exploit pass-the-hash vulnerabilities.
- [ ] Attempt to gain unauthorized access using harvested hashes.

### 12. Golden Ticket Attack

- [ ] Attempt to forge Kerberos tickets to impersonate domain controllers.
- [ ] Test for domain dominance and persistence.

### 13. Silver Ticket Attack

- [ ] Forge Kerberos tickets for specific services.
- [ ] Attempt to access target services without detection.

### 14. DCSync Attack

- [ ] Mimic domain controller synchronization requests.
- [ ] Extract password hashes and secrets from DCs.

### 15. BloodHound Analysis

- [ ] Use BloodHound for attack path analysis.
- [ ] Identify attack paths, privileges, and weaknesses.

## Post-Exploitation

### 16. Lateral Movement

- [ ] Attempt lateral movement through SMB, WMI, or remote desktop.
- [ ] Escalate privileges on compromised systems.

### 17. Persistence

- [ ] Establish persistence mechanisms in the target network.
- [ ] Create backdoors or rogue accounts.

### 18. Data Exfiltration

- [ ] Test for data exfiltration techniques.
- [ ] Attempt to transfer sensitive data to external locations.



### Active Directory Enumeration and Exploitation Tools

- [BloodHound](https://github.com/BloodHoundAD/BloodHound)
- [Mimikatz](https://github.com/gentilkiwi/mimikatz)
- [Responder](https://github.com/lgandx/Responder)
- [CrackMapExec (CME)](https://github.com/byt3bl33d3r/CrackMapExec)
- [PowerShell Empire](https://github.com/Emp

---
---

# Active Directory Checklist With Tools and Commands

## Reconnaissance

### 1. Information Gathering

- [ ] Collect information about the target network, domains, and subdomains.
  - **Tools:** [ADRecon](https://github.com/sense-of-security/ADRecon), [PowerShell](https://docs.microsoft.com/en-us/powershell/)
  - **Command:** `Get-NetDomain -Domain example.com`

- [ ] Identify domain controllers (DCs) and their roles.
  - **Tools:** PowerShell, ADRecon
  - **Command:** `Get-NetDomainController -Domain example.com`

- [ ] Enumerate domains, trusts, and forests.
  - **Tools:** ADRecon, [PowerView](https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1)
  - **Command:** `Get-NetForest -Verbose`

- [ ] Gather information about users, groups, and computers.
  - **Tools:** PowerShell, [BloodHound](https://github.com/BloodHoundAD/BloodHound)
  - **Command:** `Get-NetUser -Verbose`

- [ ] Discover organizational units (OUs) and Group Policy Objects (GPOs).
  - **Tools:** ADRecon, PowerShell
  - **Command:** `Get-NetOU -Verbose`

- [ ] Find service accounts and their permissions.
  - **Tools:** BloodHound, PowerShell
  - **Command:** `Get-NetUser -SPN`

### 2. DNS Enumeration

- [ ] Enumerate DNS information for the target domains.
  - **Tools:** [NSLookup](https://docs.microsoft.com/en-us/sysinternals/downloads/nslookup), [PowerShell](https://docs.microsoft.com/en-us/powershell/)
  - **Command:** `nslookup target`

- [ ] Identify DNS zones and records.
  - **Tools:** PowerShell, ADRecon
  - **Command:** `Get-DnsServerZone`

- [ ] Check for DNS misconfigurations or vulnerabilities.
  - **Tools:** ADRecon, PowerShell
  - **Command:** `Test-DnsServer`

## Scanning and Enumeration

### 3. SMB Enumeration

- [ ] Enumerate SMB shares and permissions.
  - **Tools:** [enum4linux](https://tools.kali.org/information-gathering/enum4linux), [smbclient](https://www.samba.org/samba/docs/current/man-html/smbclient.1.html)
  - **Command:** `enum4linux -a target`

- [ ] Identify accessible shares, including hidden shares.
  - **Tools:** enum4linux, smbclient
  - **Command:** `smbclient -L target`

- [ ] Check for misconfigured shares or exposed sensitive data.
  - **Tools:** enum4linux, smbclient
  - **Command:** `smbclient //target/share`

### 4. Port Scanning

- [ ] Perform port scanning to identify open ports and services.
  - **Tools:** [Nmap](https://nmap.org/)
  - **Command:** `nmap -p- target`

- [ ] Enumerate commonly used ports (e.g., 135, 139, 445, 3389).
  - **Tools:** Nmap
  - **Command:** `nmap -p 135,139,445,3389 target`

- [ ] Check for unusual or custom ports.
  - **Tools:** Nmap
  - **Command:** `nmap -p <port> target`

### 5. Service Enumeration

- [ ] Identify services running on target systems.
  - **Tools:** Nmap, PowerShell
  - **Command:** `Get-Service`

- [ ] Enumerate service versions and vulnerabilities.
  - **Tools:** Nmap
  - **Command:** `nmap -sV -p <port> target`

- [ ] Pay attention to RPC, LDAP, SMB, and RDP services.
  - **Tools:** Nmap, enum4linux, smbclient
  - **Command:** Varies

### 6. User Enumeration

- [ ] Enumerate users and groups.
  - **Tools:** enum4linux, smbclient
  - **Command:** `enum4linux -U target`

- [ ] Gather information about user attributes.
  - **Tools:** PowerShell
  - **Command:** `Get-ADUser -Filter *`

- [ ] Check for locked or disabled accounts.
  - **Tools:** PowerShell
  - **Command:** `Get-ADUser -Filter {Enabled -eq $false}`

- [ ] Identify high-privilege users and administrators.
  - **Tools:** PowerShell
  - **Command:** `Get-ADGroupMember "Domain Admins"`

### 7. Password Policy Assessment

- [ ] Analyze password policies and complexity requirements.
  - **Tools:** PowerShell
  - **Command:** `Get-ADDefaultDomainPasswordPolicy`

- [ ] Check for password lockout policies and expiration settings.
  - **Tools:** PowerShell
  - **Command:** `Get-ADFineGrainedPasswordPolicy`

- [ ] Look for password reuse vulnerabilities.
  - **Tools:** CrackMapExec (CME)
  - **Command:** `cme smb target -u username -p password --pwd-policies`
     
### 8. Kerberos Enumeration

- [ ] Enumerate Kerberos tickets and ticket-granting tickets (TGTs).
  - **Tools:** [Rubeus](https://github.com/GhostPack/Rubeus), PowerShell
  - **Command:** `Rubeus dump`

- [ ] Check for Kerberoasting vulnerabilities.
  - **Tools:** Rubeus
  - **Command:** `Rubeus asktgt /user:<username> /rc4:<hash>`

- [ ] Identify accounts with Kerberos pre-authentication disabled.
  - **Tools:** Rubeus
  - **Command:** `Rubeus asktgt /user:<username> /rc4:<hash> /encticket:<ticket.kirbi> /service:<SPN>`

## Vulnerability Assessment

### 9. Vulnerability Scanning

- [ ] Perform vulnerability scanning using tools.
  - **Tools:** [OpenVAS](https://www.openvas.org/), [Nessus](https://www.tenable.com/products/nessus)
  - **Command:** Varies based on the tool

- [ ] Identify and categorize vulnerabilities.
  - **Tools:** Vulnerability Scanners
  - **Command:** Varies based on the tool

- [ ] Prioritize vulnerabilities based on risk and impact.
  - **Tools:** Vulnerability Scanners
  - **Command:** Varies based on the tool

- [ ] Validate findings to eliminate false positives.
  - Manual verification

## Exploitation

### 10. Credential Harvesting

- [ ] Attempt to harvest credentials using techniques like SMB relaying.
  - **Tools:** [Responder](https://github.com/lgandx/Responder), [MultiRelay](https://github.com/SecureAuthCorp/Responder)
  - **Command:** `MultiRelay.py -t target`

- [ ] Exploit pass-the-hash (PtH) and pass-the-ticket (PtT) attacks.
  - **Tools:** [Mimikatz](https://github.com/gentilkiwi/mimikatz), [Pass-the-Ticket Toolkit](https://github.com/GhostPack/SharpRoast)
  - **Command:** Varies based on the tool

### 11. Pass-the-Hash (PtH) Attacks

- [ ] Exploit pass-the-hash vulnerabilities.
  - **Tools:** Mimikatz, Pass-the-Ticket Toolkit
  - **Command:** Varies based on the tool

- [ ] Attempt to gain unauthorized access using harvested hashes.
  - **Tools:** Mimikatz, Pass-the-Ticket Toolkit
  - **Command:** Varies based on the tool

### 12. Golden Ticket Attack

- [ ] Attempt to forge Kerberos tickets to impersonate domain controllers.
  - **Tools:** Mimikatz
  - **Command:** `kerberos::golden`

- [ ] Test for domain dominance and persistence.
  - **Tools:** Mimikatz
  - **Command:** `kerberos::tgt`

### 13. Silver Ticket Attack

- [ ] Forge Kerberos tickets for specific services.
  - **Tools:** Mimikatz
  - **Command:** `kerberos::sid`

- [ ] Attempt to access target services without detection.
  - **Tools:** Mimikatz
  - **Command:** `kerberos::tgs`

### 14. DCSync Attack

- [ ] Mimic domain controller synchronization requests.
  - **Tools:** Mimikatz
  - **Command:** `lsadump::dcsync /user:target`

- [ ] Extract password hashes and secrets from DCs.
  - **Tools:** Mimikatz
  - **Command:** `lsadump::dcsync /user:target`

### 15. BloodHound Analysis

- [ ] Use BloodHound for attack path analysis.
  - **Tools:** [BloodHound](https://github.com/BloodHoundAD/BloodHound)
  - **Command:** Varies based on the query

- [ ] Identify attack paths, privileges, and weaknesses.
  - **Tools:** BloodHound
  - **Command:** Varies based on the query

## Post-Exploitation

### 16. Lateral Movement

- [ ] Attempt lateral movement through SMB, WMI, or remote desktop.
  - **Tools:** [CrackMapExec (CME)](https://github.com/byt3bl33d3r/CrackMapExec), [PowerShell Empire](https://github.com/EmpireProject/Empire)
  - **Command:** Varies based on the tool

- [ ] Escalate privileges on compromised systems.
  - **Tools:** Various privilege escalation exploits
  - **Command:** Varies based on the exploit

### 17. Persistence

- [ ] Establish persistence mechanisms in the target network.
  - **Tools:** [Empire](https://github.com/EmpireProject/Empire), Custom scripts
  - **Command:** Varies based on the technique

- [ ] Create backdoors or rogue accounts.
  - **Tools:** [Empire](https://github.com/EmpireProject/Empire), Custom scripts
  - **Command:** Varies based on the technique

### 18. Data Exfiltration

- [ ] Test for data exfiltration techniques.
  - **Tools:** [PowerShell Empire](https://github.com/EmpireProject/Empire), Custom scripts
  - **Command:** Varies based on the technique

- [ ] Attempt to transfer sensitive data to external locations.
  - **Tools:** PowerShell Empire, Custom scripts
  - **Command:** Varies based on the technique

